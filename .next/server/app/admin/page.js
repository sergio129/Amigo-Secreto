(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},864:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(8748),t(8739),t(5866);var a=t(3191),n=t(8716),r=t(7922),i=t.n(r),l=t(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8748)),"E:\\Proyectos\\Amigo Secreto\\app\\admin\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8739)),"E:\\Proyectos\\Amigo Secreto\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["E:\\Proyectos\\Amigo Secreto\\app\\admin\\page.tsx"],m="/admin/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3952:(e,s,t)=>{Promise.resolve().then(t.bind(t,8381))},6768:(e,s,t)=>{Promise.resolve().then(t.bind(t,1713))},2763:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},8381:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var a=t(326),n=t(7577),r=t(7109),i=t(5047);function l(){let{data:e,status:s}=(0,r.useSession)(),t=(0,i.useRouter)(),[l,d]=(0,n.useState)([]),[o,m]=(0,n.useState)(!0),[u,h]=(0,n.useState)(!1),x=async()=>{try{let e=await fetch("/api/admin/events");if(e.ok){let s=await e.json();console.log("Loaded events:",s),d(s)}else console.error("Failed to load events:",e.status)}catch(e){console.error("Error loading events:",e)}finally{m(!1)}},v=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este evento? Se eliminar\xe1n tambi\xe9n todos los participantes asociados."))try{(await fetch(`/api/admin/events/${e}`,{method:"DELETE"})).ok?x():alert("Error al eliminar el evento")}catch(e){console.error("Error deleting event:",e),alert("Error al eliminar el evento")}};return"loading"===s||o?a.jsx("div",{className:"container py-5 text-center",children:a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e?(0,a.jsxs)("div",{className:"container py-4",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{children:"\uD83C\uDF81 Panel de Administraci\xf3n"}),(0,a.jsxs)("p",{className:"text-muted",children:["Bienvenido, ",e.user?.email]})]}),a.jsx("div",{children:a.jsx("button",{className:"btn btn-outline-danger",onClick:()=>{(0,r.signOut)({callbackUrl:"/admin/login"})},children:"Cerrar sesi\xf3n"})})]}),(0,a.jsxs)("div",{className:"row mb-4",children:[a.jsx("div",{className:"col-md-4",children:a.jsx("div",{className:"card stats-card",children:(0,a.jsxs)("div",{className:"card-body text-center",children:[a.jsx("div",{className:"stats-icon",children:"\uD83C\uDF84"}),a.jsx("h3",{children:l.length}),a.jsx("p",{className:"text-muted",children:"Eventos Totales"})]})})}),a.jsx("div",{className:"col-md-4",children:a.jsx("div",{className:"card stats-card",children:(0,a.jsxs)("div",{className:"card-body text-center",children:[a.jsx("div",{className:"stats-icon",children:"✅"}),a.jsx("h3",{children:l.filter(e=>e.isActive).length}),a.jsx("p",{className:"text-muted",children:"Eventos Activos"})]})})}),a.jsx("div",{className:"col-md-4",children:a.jsx("div",{className:"card stats-card",children:(0,a.jsxs)("div",{className:"card-body text-center",children:[a.jsx("div",{className:"stats-icon",children:"\uD83D\uDC65"}),a.jsx("h3",{children:l.reduce((e,s)=>e+(s.participantCount||0),0)}),a.jsx("p",{className:"text-muted",children:"Participantes Totales"})]})})})]}),(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[a.jsx("h2",{children:"Eventos"}),a.jsx("button",{className:"btn btn-gradient",onClick:()=>h(!0),children:"➕ Crear Evento"})]}),0===l.length?a.jsx("div",{className:"card",children:(0,a.jsxs)("div",{className:"card-body text-center py-5",children:[a.jsx("div",{className:"mb-3",children:"\uD83C\uDF81"}),a.jsx("h4",{children:"No hay eventos creados"}),a.jsx("p",{className:"text-muted",children:"Crea tu primer evento de Amigo Secreto"}),a.jsx("button",{className:"btn btn-gradient",onClick:()=>h(!0),children:"Crear Primer Evento"})]})}):a.jsx("div",{className:"row",children:l.map(e=>a.jsx("div",{className:"col-md-6 col-lg-4 mb-3",children:(0,a.jsxs)("div",{className:"card event-card h-100",children:[(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[a.jsx("h5",{className:"card-title",children:e.name}),a.jsx("span",{className:`badge ${e.isActive?"bg-success":"bg-secondary"}`,children:e.isActive?"Activo":"Inactivo"})]}),a.jsx("p",{className:"card-text text-muted",children:e.description}),a.jsx("p",{className:"card-text",children:(0,a.jsxs)("small",{className:"text-muted",children:["\uD83D\uDCC5 ",new Date(e.date).toLocaleDateString("es-ES")]})}),a.jsx("p",{className:"card-text",children:(0,a.jsxs)("small",{className:"text-muted",children:["\uD83D\uDC65 ",e.participantCount||0," participantes"]})})]}),(0,a.jsxs)("div",{className:"card-footer bg-transparent",children:[a.jsx("button",{className:"btn btn-outline-primary btn-sm me-2",onClick:()=>t.push(`/admin/events/${e._id}`),children:"Gestionar"}),a.jsx("button",{className:"btn btn-outline-success btn-sm me-2",onClick:()=>window.open(`/event/${e._id}`,"_blank"),children:"Ver P\xfablico"}),a.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>v(e._id),children:"Eliminar"})]})]})},e._id))}),u&&a.jsx(c,{onClose:()=>h(!1),onSuccess:()=>{h(!1),x()}})]}):null}function c({onClose:e,onSuccess:s}){let[t,r]=(0,n.useState)({name:"",description:"",date:""}),[i,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),o=async e=>{e.preventDefault(),l(!0),d("");try{let e=await fetch("/api/admin/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok)s();else{let s=await e.json();d(s.error||"Error al crear el evento")}}catch(e){d("Error de conexi\xf3n")}finally{l(!1)}};return a.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:a.jsx("div",{className:"modal-dialog",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[a.jsx("h5",{className:"modal-title",children:"Crear Nuevo Evento"}),a.jsx("button",{type:"button",className:"btn-close",onClick:e})]}),(0,a.jsxs)("form",{onSubmit:o,children:[(0,a.jsxs)("div",{className:"modal-body",children:[c&&a.jsx("div",{className:"alert alert-danger",children:c}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"name",className:"form-label",children:"Nombre del Evento"}),a.jsx("input",{type:"text",className:"form-control",id:"name",value:t.name,onChange:e=>r({...t,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:"Descripci\xf3n"}),a.jsx("textarea",{className:"form-control",id:"description",rows:3,value:t.description,onChange:e=>r({...t,description:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"date",className:"form-label",children:"Fecha del Evento"}),a.jsx("input",{type:"date",className:"form-control",id:"date",value:t.date,onChange:e=>r({...t,date:e.target.value}),required:!0})]})]}),(0,a.jsxs)("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-gradient",disabled:i,children:i?"Creando...":"Crear Evento"})]})]})]})})})}},1713:(e,s,t)=>{"use strict";t.d(s,{default:()=>r});var a=t(326),n=t(7109);function r({children:e}){return a.jsx(n.SessionProvider,{children:e})}},5047:(e,s,t)=>{"use strict";var a=t(7389);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},8748:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\app\admin\page.tsx#default`)},8739:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c,metadata:()=>l});var a=t(9510),n=t(7366),r=t.n(n);t(7272);let i=(0,t(8570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\components\SessionProvider.tsx#default`),l={title:"Amigo Secreto",description:"Selecciona tu nombre y descubre a qui\xe9n debes regalar"};function c({children:e}){return(0,a.jsxs)("html",{lang:"es",children:[(0,a.jsxs)("head",{children:[a.jsx("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css",rel:"stylesheet"}),a.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap",rel:"stylesheet"}),a.jsx("link",{rel:"icon",href:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'%3E%3Ctext y='32' font-size='32'%3E%F0%9F%8E%81%3C/text%3E%3C/svg%3E"})]}),(0,a.jsxs)("body",{className:r().className,children:[a.jsx(i,{children:e}),a.jsx("script",{src:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"})]})]})}},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,571],()=>t(864));module.exports=a})();