(()=>{var e={};e.id=699,e.ids=[699],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},26030:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>r.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>o}),t(1121),t(68739),t(35866);var s=t(23191),n=t(88716),i=t(37922),r=t.n(i),l=t(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(a,c);let o=["",{children:["admin",{children:["events",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1121)),"E:\\Proyectos\\Amigo Secreto\\app\\admin\\events\\[id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,68739)),"E:\\Proyectos\\Amigo Secreto\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],d=["E:\\Proyectos\\Amigo Secreto\\app\\admin\\events\\[id]\\page.tsx"],m="/admin/events/[id]/page",h={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/admin/events/[id]/page",pathname:"/admin/events/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},38319:(e,a,t)=>{Promise.resolve().then(t.bind(t,21052))},46768:(e,a,t)=>{Promise.resolve().then(t.bind(t,41713))},72763:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},21052:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l});var s=t(10326),n=t(17577),i=t(77109),r=t(35047);function l(){let{data:e,status:a}=(0,i.useSession)(),t=(0,r.useRouter)(),l=(0,r.useParams)().id,[o,d]=(0,n.useState)(null),[m,h]=(0,n.useState)(!0),[u,p]=(0,n.useState)(!1),[x,b]=(0,n.useState)(!1),[j,v]=(0,n.useState)(null),[g,N]=(0,n.useState)({name:"",email:""}),y=async()=>{try{let e=await fetch(`/api/admin/events/${l}`);if(e.ok){let a=await e.json();d(a)}}catch(e){console.error("Error loading event:",e)}finally{h(!1)}},f=async e=>{e.preventDefault();try{(await fetch(`/api/admin/events/${l}/participants`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).ok&&(p(!1),N({name:"",email:""}),y())}catch(e){console.error("Error adding participant:",e)}},P=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este participante?"))try{(await fetch(`/api/admin/events/${l}/participants/${e}`,{method:"DELETE"})).ok&&y()}catch(e){console.error("Error deleting participant:",e)}},C=e=>{v(e),b(!0)},E=async()=>{if(o)try{(await fetch(`/api/admin/events/${l}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!o.isActive})})).ok&&y()}catch(e){console.error("Error updating event:",e)}};return"loading"===a||m?s.jsx("div",{className:"container py-5 text-center",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e&&o?(0,s.jsxs)("div",{className:"container py-4",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{children:"\uD83C\uDF81 Gestionar Evento"}),s.jsx("h3",{children:o.name}),s.jsx("p",{className:"text-muted",children:o.description})]}),(0,s.jsxs)("div",{children:[s.jsx("button",{className:"btn btn-outline-secondary me-2",onClick:()=>t.push("/admin"),children:"← Volver"}),s.jsx("button",{className:`btn ${o.isActive?"btn-warning":"btn-success"}`,onClick:E,children:o.isActive?"Desactivar":"Activar"})]})]}),(0,s.jsxs)("div",{className:"row mb-4",children:[s.jsx("div",{className:"col-md-6",children:s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"card-body",children:[s.jsx("h5",{className:"card-title",children:"\uD83D\uDCCA Estad\xedsticas"}),(0,s.jsxs)("p",{className:"mb-1",children:["\uD83D\uDC65 Participantes: ",o.participants.length]}),(0,s.jsxs)("p",{className:"mb-1",children:["\uD83D\uDCC5 Fecha: ",new Date(o.date).toLocaleDateString("es-ES")]}),(0,s.jsxs)("p",{className:"mb-0",children:["\uD83D\uDCCA Estado: ",o.isActive?"Activo":"Inactivo"]})]})})}),s.jsx("div",{className:"col-md-6",children:s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"card-body",children:[s.jsx("h5",{className:"card-title",children:"\uD83D\uDD17 Enlaces"}),s.jsx("p",{children:s.jsx("a",{href:`/event/${o._id}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline-primary btn-sm me-2",children:"Ver P\xe1gina P\xfablica"})})]})})})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[s.jsx("h2",{children:"Participantes"}),s.jsx("button",{className:"btn btn-gradient",onClick:()=>p(!0),children:"➕ Agregar Participante"})]}),0===o.participants.length?s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"card-body text-center py-5",children:[s.jsx("div",{className:"mb-3",children:"\uD83D\uDC65"}),s.jsx("h4",{children:"No hay participantes"}),s.jsx("p",{className:"text-muted",children:"Agrega participantes para que puedan seleccionar su amigo secreto"}),s.jsx("button",{className:"btn btn-gradient",onClick:()=>p(!0),children:"Agregar Primer Participante"})]})}):s.jsx("div",{className:"card",children:s.jsx("div",{className:"card-body",children:s.jsx("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-hover",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.participants.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:e.name}),s.jsx("td",{children:e.email||"-"}),(0,s.jsxs)("td",{children:[s.jsx("button",{className:"btn btn-outline-warning btn-sm me-2",onClick:()=>C(e),children:"✏️ Editar"}),s.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>P(e._id),children:"Eliminar"})]})]},e._id))})]})})})}),u&&s.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:s.jsx("div",{className:"modal-dialog",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title",children:"Agregar Participante"}),s.jsx("button",{type:"button",className:"btn-close",onClick:()=>p(!1)})]}),(0,s.jsxs)("form",{onSubmit:f,children:[(0,s.jsxs)("div",{className:"modal-body",children:[(0,s.jsxs)("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:"Nombre *"}),s.jsx("input",{type:"text",className:"form-control",id:"name",value:g.name,onChange:e=>N({...g,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"email",className:"form-label",children:"Email (opcional)"}),s.jsx("input",{type:"email",className:"form-control",id:"email",value:g.email,onChange:e=>N({...g,email:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>p(!1),children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn btn-gradient",children:"Agregar Participante"})]})]})]})})}),x&&j&&s.jsx(c,{participant:j,eventId:l,onClose:()=>{b(!1),v(null)},onSuccess:()=>{b(!1),v(null),y()}})]}):null}function c({participant:e,eventId:a,onClose:t,onSuccess:i}){let[r,l]=(0,n.useState)({name:e.name,email:e.email||""}),[c,o]=(0,n.useState)(!1),[d,m]=(0,n.useState)(""),h=async t=>{t.preventDefault(),o(!0),m("");try{let t=await fetch(`/api/admin/events/${a}/participants/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(t.ok)i();else{let e=await t.json();m(e.error||"Error al actualizar el participante")}}catch(e){console.error("Error updating participant:",e),m("Error al actualizar el participante")}finally{o(!1)}};return s.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:s.jsx("div",{className:"modal-dialog",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title",children:"✏️ Editar Participante"}),s.jsx("button",{type:"button",className:"btn-close",onClick:t})]}),(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsxs)("div",{className:"modal-body",children:[d&&s.jsx("div",{className:"alert alert-danger",children:d}),(0,s.jsxs)("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"edit-participant-name",className:"form-label",children:"Nombre"}),s.jsx("input",{type:"text",className:"form-control",id:"edit-participant-name",value:r.name,onChange:e=>l({...r,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"edit-participant-email",className:"form-label",children:"Email (opcional)"}),s.jsx("input",{type:"email",className:"form-control",id:"edit-participant-email",value:r.email,onChange:e=>l({...r,email:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn btn-gradient",disabled:c,children:c?"Actualizando...":"Actualizar Participante"})]})]})]})})})}},41713:(e,a,t)=>{"use strict";t.d(a,{default:()=>i});var s=t(10326),n=t(77109);function i({children:e}){return s.jsx(n.SessionProvider,{children:e})}},35047:(e,a,t)=>{"use strict";var s=t(77389);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},1121:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\app\admin\events\[id]\page.tsx#default`)},68739:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c,metadata:()=>l});var s=t(19510),n=t(77366),i=t.n(n);t(67272);let r=(0,t(68570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\components\SessionProvider.tsx#default`),l={title:"Amigo Secreto",description:"Selecciona tu nombre y descubre a qui\xe9n debes regalar"};function c({children:e}){return(0,s.jsxs)("html",{lang:"es",children:[(0,s.jsxs)("head",{children:[s.jsx("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css",rel:"stylesheet"}),s.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap",rel:"stylesheet"}),s.jsx("link",{rel:"icon",href:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'%3E%3Ctext y='32' font-size='32'%3E%F0%9F%8E%81%3C/text%3E%3C/svg%3E"})]}),(0,s.jsxs)("body",{className:i().className,children:[s.jsx(r,{children:e}),s.jsx("script",{src:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"})]})]})}},67272:()=>{}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[276,571],()=>t(26030));module.exports=s})();