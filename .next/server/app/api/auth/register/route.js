"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},66470:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(49303),a=t(88716),n=t(60670),i=t(87070),u=t(42023),p=t.n(u),c=t(2021);async function d(e){try{let{name:r,email:t,password:s}=await e.json();if(!r||!t||!s)return i.NextResponse.json({error:"Todos los campos son requeridos"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return i.NextResponse.json({error:"Email inv\xe1lido"},{status:400});if(s.length<6)return i.NextResponse.json({error:"La contrase\xf1a debe tener al menos 6 caracteres"},{status:400});let o=(await c.Z).db("SaludDirecta");if(await o.collection("amigo_secreto_users").findOne({email:t.toLowerCase()}))return i.NextResponse.json({error:"El email ya est\xe1 registrado"},{status:400});let a=await p().hash(s,12),n=await o.collection("amigo_secreto_users").insertOne({name:r.trim(),email:t.toLowerCase().trim(),password:a,role:"guest",maxEvents:5,createdAt:new Date});return i.NextResponse.json({success:!0,userId:n.insertedId})}catch(e){return console.error("Error registering user:",e),i.NextResponse.json({error:"Error interno del servidor"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"E:\\Proyectos\\Amigo Secreto\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=l,v="/api/auth/register/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},2021:(e,r,t)=>{t.d(r,{Z:()=>a});var s=t(38013);if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let o=process.env.MONGODB_URI,a=new s.MongoClient(o,{}).connect()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,23],()=>t(66470));module.exports=s})();