(()=>{var e={};e.id=744,e.ids=[744],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4548:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(721),t(8739),t(5866);var r=t(3191),a=t(8716),i=t(7922),n=t.n(i),o=t(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);let c=["",{children:["event",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,721)),"E:\\Proyectos\\Amigo Secreto\\app\\event\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8739)),"E:\\Proyectos\\Amigo Secreto\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["E:\\Proyectos\\Amigo Secreto\\app\\event\\[id]\\page.tsx"],m="/event/[id]/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/event/[id]/page",pathname:"/event/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},335:(e,s,t)=>{Promise.resolve().then(t.bind(t,2100))},6768:(e,s,t)=>{Promise.resolve().then(t.bind(t,1713))},2763:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},2100:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var r=t(326),a=t(7577),i=t(5047);function n(){(0,i.useParams)().id;let[e,s]=(0,a.useState)(null),[t,n]=(0,a.useState)(!0),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[m,u]=(0,a.useState)(""),[p,h]=(0,a.useState)({}),[x,g]=(0,a.useState)(new Set),[v,b]=(0,a.useState)(null),j=(e,s="info")=>{b({message:e,type:s,show:!0}),setTimeout(()=>{b(null)},5e3)},y=async s=>{if(!x.has(s)&&!c){l(s);try{if(e){let t=await fetch(`/api/public/events/${e._id}/assignments`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({participantName:s})});if(t.ok){let e=await t.json();u(e.assignment.receiver),d(!0);let r=new Set(x);r.add(s),g(r)}else{let e=await t.json();console.error("Error generating assignment:",e),"No hay participantes disponibles para asignar"===e.error?j("\uD83C\uDF84 \xa1Felicitaciones! Ya todos los participantes han descubierto sus amigos secretos. El intercambio puede comenzar. \uD83C\uDF81","success"):"Participante ya revelado"===e.error?j("Ya has descubierto tu amigo secreto anteriormente.","info"):j("Error al generar la asignaci\xf3n. Int\xe9ntalo de nuevo.","error")}}}catch(e){console.error("Error generating assignment:",e),alert("Error al generar la asignaci\xf3n. Int\xe9ntalo de nuevo.")}}};return t?r.jsx("div",{className:"container py-5",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"spinner-border text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Cargando..."})}),r.jsx("p",{className:"mt-3",children:"Cargando evento..."})]})}):e?(0,r.jsxs)("div",{className:"container py-5",children:[(0,r.jsxs)("div",{className:"text-center mb-5",children:[(0,r.jsxs)("h1",{className:"display-title mb-3",children:["\uD83C\uDF81 ",e.name]}),r.jsx("p",{className:"text-muted mb-4",children:e.description}),r.jsx("div",{className:"mb-4",children:(0,r.jsxs)("small",{className:"text-muted",children:["\uD83D\uDC65 ",e.participants.length," participantes"]})})]}),(0,r.jsxs)("div",{className:"main-card mx-auto p-4",children:[(0,r.jsxs)("div",{className:"text-center mb-4",children:[r.jsx("h3",{className:"mb-3",children:"Selecciona tu nombre"}),r.jsx("p",{className:"text-muted",children:"Haz clic en tu nombre para descubrir a qui\xe9n debes regalar"})]}),r.jsx("div",{className:"row justify-content-center",children:r.jsx("div",{className:"col-md-8",children:r.jsx("div",{className:"list-group",id:"participantsList",children:e.participants.map(e=>{let s=x.has(e.name);return(0,r.jsxs)("button",{className:`list-group-item list-group-item-action d-flex justify-content-between align-items-center ${s?"disabled":""}`,onClick:()=>y(e.name),disabled:s,children:[r.jsx("span",{children:e.name}),s&&r.jsx("span",{className:"badge bg-success",children:"Revelado"})]},e._id)})})})}),(0,r.jsxs)("div",{className:"text-center mt-4",children:[r.jsx("div",{className:"mb-2",children:(0,r.jsxs)("small",{className:"text-muted",children:[x.size," de ",e.participants.length," participantes han descubierto su amigo secreto"]})}),x.size===e.participants.length?r.jsx("div",{className:"alert alert-success py-2",children:r.jsx("small",{children:"\uD83C\uDF84 \xa1Felicitaciones! Todos los participantes han descubierto sus amigos secretos. \xa1El intercambio puede comenzar! \uD83C\uDF81"})}):r.jsx("div",{className:"progress",style:{height:"6px"},children:r.jsx("div",{className:"progress-bar bg-success",style:{width:`${x.size/e.participants.length*100}%`}})})]})]}),c&&r.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.8)",zIndex:1060},children:r.jsx("div",{className:"modal-dialog modal-dialog-centered",children:r.jsx("div",{className:"modal-content party-modal",children:(0,r.jsxs)("div",{className:"modal-body text-center p-5",children:[r.jsx("div",{className:"mb-4",children:r.jsx("span",{style:{fontSize:"3rem"},children:"\uD83C\uDF89"})}),r.jsx("h4",{className:"mb-3",children:"\xa1Felicitaciones!"}),(0,r.jsxs)("div",{id:"secretAssignedText",children:[o,", ",r.jsx("br",{}),"tu Amigo Secreto es:",r.jsx("br",{}),r.jsx("strong",{style:{fontSize:"1.6rem",color:"#ff6b6b"},children:m})]}),r.jsx("button",{className:"btn btn-gradient mt-4 px-4 py-2",onClick:()=>{d(!1),l(null),u("")},style:{zIndex:1061},children:"\xa1Entendido!"})]})})})}),v&&v.show&&(0,r.jsxs)("div",{className:"toast show position-fixed",style:{top:"20px",right:"20px",zIndex:1070,minWidth:"300px"},role:"alert","aria-live":"assertive","aria-atomic":"true",children:[(0,r.jsxs)("div",{className:`toast-header bg-${"success"===v.type?"success":"error"===v.type?"danger":"info"} text-white`,children:[(0,r.jsxs)("strong",{className:"me-auto",children:["success"===v.type&&"\uD83C\uDF84 \xa1Felicitaciones!","error"===v.type&&"❌ Error","info"===v.type&&"ℹ️ Informaci\xf3n"]}),r.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:()=>{b(null)},"aria-label":"Close"})]}),r.jsx("div",{className:"toast-body",children:v.message})]})]}):r.jsx("div",{className:"container py-5",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"mb-4",children:r.jsx("span",{style:{fontSize:"4rem"},children:"\uD83C\uDF84"})}),r.jsx("h2",{children:"Evento no encontrado"}),r.jsx("p",{className:"text-muted",children:"El evento que buscas no existe o ha sido eliminado"})]})})}},1713:(e,s,t)=>{"use strict";t.d(s,{default:()=>i});var r=t(326),a=t(7109);function i({children:e}){return r.jsx(a.SessionProvider,{children:e})}},5047:(e,s,t)=>{"use strict";var r=t(7389);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}})},721:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\app\event\[id]\page.tsx#default`)},8739:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>o});var r=t(9510),a=t(7366),i=t.n(a);t(7272);let n=(0,t(8570).createProxy)(String.raw`E:\Proyectos\Amigo Secreto\components\SessionProvider.tsx#default`),o={title:"Amigo Secreto",description:"Selecciona tu nombre y descubre a qui\xe9n debes regalar"};function l({children:e}){return(0,r.jsxs)("html",{lang:"es",children:[(0,r.jsxs)("head",{children:[r.jsx("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css",rel:"stylesheet"}),r.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap",rel:"stylesheet"}),r.jsx("link",{rel:"icon",href:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'%3E%3Ctext y='32' font-size='32'%3E%F0%9F%8E%81%3C/text%3E%3C/svg%3E"})]}),(0,r.jsxs)("body",{className:i().className,children:[r.jsx(n,{children:e}),r.jsx("script",{src:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"})]})]})}},7272:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,571],()=>t(4548));module.exports=r})();