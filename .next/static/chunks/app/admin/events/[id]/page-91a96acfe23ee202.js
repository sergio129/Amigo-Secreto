(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[699],{7281:function(e,a,s){Promise.resolve().then(s.bind(s,2514))},2514:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return r}});var n=s(7437),t=s(2265),i=s(605),c=s(9376);function r(){let{data:e,status:a}=(0,i.useSession)(),s=(0,c.useRouter)(),r=(0,c.useParams)().id,[l,d]=(0,t.useState)(null),[o,m]=(0,t.useState)(!0),[h,u]=(0,t.useState)(!1),[x,j]=(0,t.useState)({name:"",email:""});(0,t.useEffect)(()=>{if("loading"!==a){if(!e){s.push("/admin/login");return}r&&b()}},[e,a,s,r]);let b=async()=>{try{let e=await fetch("/api/admin/events/".concat(r));if(e.ok){let a=await e.json();d(a)}}catch(e){console.error("Error loading event:",e)}finally{m(!1)}},p=async e=>{e.preventDefault();try{(await fetch("/api/admin/events/".concat(r,"/participants"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)})).ok&&(u(!1),j({name:"",email:""}),b())}catch(e){console.error("Error adding participant:",e)}},v=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este participante?"))try{(await fetch("/api/admin/events/".concat(r,"/participants/").concat(e),{method:"DELETE"})).ok&&b()}catch(e){console.error("Error deleting participant:",e)}},N=async()=>{if(l)try{(await fetch("/api/admin/events/".concat(r),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!l.isActive})})).ok&&b()}catch(e){console.error("Error updating event:",e)}};return"loading"===a||o?(0,n.jsx)("div",{className:"container py-5 text-center",children:(0,n.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,n.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}):e&&l?(0,n.jsxs)("div",{className:"container py-4",children:[(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"\uD83C\uDF81 Gestionar Evento"}),(0,n.jsx)("h3",{children:l.name}),(0,n.jsx)("p",{className:"text-muted",children:l.description})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{className:"btn btn-outline-secondary me-2",onClick:()=>s.push("/admin"),children:"← Volver"}),(0,n.jsx)("button",{className:"btn ".concat(l.isActive?"btn-warning":"btn-success"),onClick:N,children:l.isActive?"Desactivar":"Activar"})]})]}),(0,n.jsxs)("div",{className:"row mb-4",children:[(0,n.jsx)("div",{className:"col-md-6",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:"\uD83D\uDCCA Estad\xedsticas"}),(0,n.jsxs)("p",{className:"mb-1",children:["\uD83D\uDC65 Participantes: ",l.participants.length]}),(0,n.jsxs)("p",{className:"mb-1",children:["\uD83D\uDCC5 Fecha: ",new Date(l.date).toLocaleDateString("es-ES")]}),(0,n.jsxs)("p",{className:"mb-0",children:["\uD83D\uDCCA Estado: ",l.isActive?"Activo":"Inactivo"]})]})})}),(0,n.jsx)("div",{className:"col-md-6",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:"\uD83D\uDD17 Enlaces"}),(0,n.jsx)("p",{children:(0,n.jsx)("a",{href:"/event/".concat(l._id),target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline-primary btn-sm me-2",children:"Ver P\xe1gina P\xfablica"})})]})})})]}),(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,n.jsx)("h2",{children:"Participantes"}),(0,n.jsx)("button",{className:"btn btn-gradient",onClick:()=>u(!0),children:"➕ Agregar Participante"})]}),0===l.participants.length?(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body text-center py-5",children:[(0,n.jsx)("div",{className:"mb-3",children:"\uD83D\uDC65"}),(0,n.jsx)("h4",{children:"No hay participantes"}),(0,n.jsx)("p",{className:"text-muted",children:"Agrega participantes para que puedan seleccionar su amigo secreto"}),(0,n.jsx)("button",{className:"btn btn-gradient",onClick:()=>u(!0),children:"Agregar Primer Participante"})]})}):(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("div",{className:"card-body",children:(0,n.jsx)("div",{className:"table-responsive",children:(0,n.jsxs)("table",{className:"table table-hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Nombre"}),(0,n.jsx)("th",{children:"Email"}),(0,n.jsx)("th",{children:"Acciones"})]})}),(0,n.jsx)("tbody",{children:l.participants.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.name}),(0,n.jsx)("td",{children:e.email||"-"}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>v(e._id),children:"Eliminar"})})]},e._id))})]})})})}),h&&(0,n.jsx)("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,n.jsx)("div",{className:"modal-dialog",children:(0,n.jsxs)("div",{className:"modal-content",children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h5",{className:"modal-title",children:"Agregar Participante"}),(0,n.jsx)("button",{type:"button",className:"btn-close",onClick:()=>u(!1)})]}),(0,n.jsxs)("form",{onSubmit:p,children:[(0,n.jsxs)("div",{className:"modal-body",children:[(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:"name",className:"form-label",children:"Nombre *"}),(0,n.jsx)("input",{type:"text",className:"form-control",id:"name",value:x.name,onChange:e=>j({...x,name:e.target.value}),required:!0})]}),(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email (opcional)"}),(0,n.jsx)("input",{type:"email",className:"form-control",id:"email",value:x.email,onChange:e=>j({...x,email:e.target.value})})]})]}),(0,n.jsxs)("div",{className:"modal-footer",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>u(!1),children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-gradient",children:"Agregar Participante"})]})]})]})})})]}):null}},9376:function(e,a,s){"use strict";var n=s(5475);s.o(n,"useParams")&&s.d(a,{useParams:function(){return n.useParams}}),s.o(n,"useRouter")&&s.d(a,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[605,971,117,560],function(){return e(e.s=7281)}),_N_E=e.O()}]);